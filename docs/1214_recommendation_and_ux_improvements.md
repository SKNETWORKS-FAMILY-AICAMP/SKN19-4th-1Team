# 2025-12-14 추천 로직 및 UX 개선 작업 내역

## 1. 학과 추천 트리거 정확도 개선

- **문제**: 사용자가 "추천 시작"을 입력했을 때, 간헐적으로 `list_departments` 툴이 호출되거나 프론트엔드 트리거가 작동하지 않는 문제 발생.
- **해결**:
  - **Frontend (`chat.js`)**: 트리거 조건을 `text === '추천 시작'`에서 공백 제거 및 포함 여부 확인(`cleanedText === '추천시작' || text.includes('추천 시작')`)으로 완화하여 인식률 개선.
  - **Backend (`nodes.py`)**: 시스템 프롬프트에 "추천 시작" 입력 시 절대 `list_departments`를 호출하지 말고, 올바른 가이드를 제공하도록 지침 추가.

## 2. 레거시 스코어링 로직 제거

- **작업**: `backend/graph/nodes.py` 내의 `SCORE_TIER_...` 상수 및 주석 처리되어 있던 복잡한 가중치 부여 로직(키워드 매칭 부스팅 등)을 완전히 삭제하여 코드 복잡도 감소.

## 3. 온보딩 설문(Survey) 최적화

- **목표**: 진로가 불분명한 예비 대학생에게 더 적합한 추천을 제공하기 위해 질문 개선.
- **변경 사항 (`chat.js`, `nodes.py`)**:
  - **직업(Job) 중심 → 성향(Vibe) 중심**:
    - `career_goal` (장래 희망) → **"관심 활동 유형"** (예: 남을 돕는 일, 분석하는 일)
    - `strengths` (성격/장점) → **"선호 환경 및 성향"** (예: 혼자 탐구 vs 팀 협력)
  - **신규 항목 추가**:
    - `topics`: **"평소 관심 주제"** (유튜브/뉴스 등에서 접하는 관심사)
    - `learning_style`: **"이론 탐구 vs 실전 활동"** (학습 방식 선호도)
  - **백엔드 매핑**: 추가된 `topics`, `learning_style`이 사용자 프로필 텍스트 생성에 반영되도록 `nodes.py` 수정.

## 4. '새 채팅' UX 개선

- **문제**: '새 채팅' 아이콘 클릭 시 즉시 온보딩(학과 추천) 모드로 진입하여 사용자 혼란 야기.
- **해결**: `resetChat` 함수 수정.
  - 온보딩 상태를 `isComplete: true`로 설정하여 일반 대화 모드로 시작.
  - "새로운 대화를 시작합니다!"라는 환영 인사를 출력하도록 변경.

## 5. 타이핑 효과(Typing Effect) 버그 수정

- **문제**: 브라우저 탭이 비활성화(백그라운드)되면 `setTimeout` 스로틀링으로 인해 AI 답변 타이핑이 멈추거나 매우 느려지는 현상.
- **해결**: `Date.now()`를 이용한 **Time-based** 로직으로 변경.
  - 탭이 백그라운드에 있다가 돌아오면, 경과된 시간에 맞춰 밀린 글자들이 즉시 출력되도록 수정.
