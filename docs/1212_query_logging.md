# DB 쿼리 로깅 기능 구현

## 개요
기존에 콘솔창에서만 확인 가능하던 데이터베이스 쿼리 실행 내역과 결과를 파일로 저장하여, 보다 체계적인 디버깅과 모니터링이 가능하도록 기능을 개선했습니다.

## 수정 내용

### 1. 로그 파일 저장 경로 생성
- **경로**: `backend/db/logs`
- 해당 디렉토리가 없을 경우 자동으로 생성되도록 처리했습니다.

### 2. SQLAlchemy 이벤트 리스너 등록
`backend/db/connection.py` 파일의 `engine` 객체에 SQLAlchemy 이벤트 리스너를 추가하여 쿼리 실행 전후의 정보를 캡처합니다.

- **`before_cursor_execute`**: 
  - 실행되는 SQL 쿼리문과 파라미터를 로깅합니다.
  - 쿼리 시작 시간을 기록합니다.
  
- **`after_cursor_execute`**:
  - 쿼리 실행 소요 시간을 계산하여 로깅합니다.
  - `cursor.rowcount`를 통해 영향 받은 행(Row)의 개수를 로깅합니다.

### 3. 로그 파일 형식
로그는 `backend/db/logs/query_log.log` 파일에 저장되며, 다음과 같은 형식을 따릅니다.

```log
[2024-05-21 14:00:00] 📝 QUERY: SELECT * FROM universities WHERE ...
[2024-05-21 14:00:00] 🔧 PARAMS: {'name': '서울대학교'}
[2024-05-21 14:00:00] ⏱️ EXECUTION TIME: 0.0053s
[2024-05-21 14:00:00] 🔢 ROWS AFFECTED: 1
[2024-05-21 14:00:00] --------------------------------------------------
```

## 해결 과정
1. **문제 분석**: 사용자 요청에 따라 DB 쿼리 로그가 콘솔에만 출력되어 휘발되는 문제를 식별했습니다.
2. **솔루션 설계**: SQLAlchemy의 `echo=True` 옵션 대신, 커스텀 로거와 이벤트 리스너를 사용하여 상세 정보를 파일로 기록하는 방식을 채택했습니다.
3. **구현**: `logging` 모듈을 사용하여 `query_log.log` 파일 핸들러를 설정하고, `sqlalchemy.event`를 통해 쿼리 실행 사이클에 개입하여 로그를 남기도록 구현했습니다.

## 참고 사항
- 로그 파일은 계속 누적되므로, 추후 로그 로테이션(Log Rotation) 정책 적용을 고려할 수 있습니다.
